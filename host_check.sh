#!/bin/bash

# –°–∫—Ä–∏–ø—Ç 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ —Ö–æ—Å—Ç–∞

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∞—Ä–≥—É–º–µ–Ω—Ç—É
if [ -z "$1" ]; then
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞: –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å IP-–∞–¥—Ä–µ—Å—É —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç."
    echo "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: $0 <IP-–∞–¥—Ä–µ—Å–∞>"
    exit 1
fi

IP_ADDRESS="$1"
TIMESTAMP=$(date +"%Y-%m-%d_%H%M%S")
OUTPUT_FILE="$HOME/host_check_result_$TIMESTAMP.txt"
LOG_HEADER="--- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –•–æ—Å—Ç–∞: $IP_ADDRESS ---"

echo "‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ —Ö–æ—Å—Ç–∞ $IP_ADDRESS..."

# –í–∏–∫–æ–Ω–∞–Ω–Ω—è ping: -c 4 (4 –∑–∞–ø–∏—Ç–∏), -W 1 (—Ç–∞–π–º–∞—É—Ç 1 —Å–µ–∫—É–Ω–¥–∞)
# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ –∫–æ–¥ –≤–∏—Ö–æ–¥—É –∫–æ–º–∞–Ω–¥–∏ ping
if ping -c 4 -W 1 "$IP_ADDRESS" > /dev/null 2>&1; then
    # –•–æ—Å—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π
    echo "‚úÖ –•–æ—Å—Ç $IP_ADDRESS **–¥–æ—Å—Ç—É–ø–Ω–∏–π**."
    
    # –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
    {
        echo "$LOG_HEADER"
        echo "–°—Ç–∞—Ç—É—Å: –î–û–°–¢–£–ü–ù–ò–ô"
        echo "–î–∞—Ç–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏: $TIMESTAMP"
        echo "--- –î–µ—Ç–∞–ª—ñ (–ø–æ–≤–Ω–∏–π –≤–∏–≤—ñ–¥ ping): ---"
        ping -c 4 -W 1 "$IP_ADDRESS"
    } > "$OUTPUT_FILE"
    
    echo "üìÅ –§–∞–π–ª –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é —Å—Ç–≤–æ—Ä–µ–Ω–æ —É: $OUTPUT_FILE"
else
    # –•–æ—Å—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
    echo "üî¥ –•–æ—Å—Ç $IP_ADDRESS **–Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π**."
fi

exit 0

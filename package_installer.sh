#!/bin/bash

# –°–∫—Ä–∏–ø—Ç 3: –ü–æ—à—É–∫ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –∞—Ä–≥—É–º–µ–Ω—Ç—É
if [ -z "$1" ]; then
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞: –ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –ø–∞–∫–µ—Ç–∞ —è–∫ –∞—Ä–≥—É–º–µ–Ω—Ç."
    echo "–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: $0 <–Ω–∞–∑–≤–∞-–ø–∞–∫–µ—Ç–∞>"
    exit 1
fi

PACKAGE_NAME="$1"

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ apt)
if ! command -v apt &> /dev/null; then
    echo "‚ö†Ô∏è –ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è: apt –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. –°–∫—Ä–∏–ø—Ç —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–æ –¥–ª—è Debian/Ubuntu."
    echo "–ë—É–¥—å –ª–∞—Å–∫–∞, –∞–¥–∞–ø—Ç—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–∏ –ø—ñ–¥ –≤–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç—ñ–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, yum, dnf, pacman)."
    exit 1
fi

echo "‚è≥ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ –ø–∞–∫–µ—Ç–∞ '$PACKAGE_NAME'..."

# –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —á–∏ –ø–∞–∫–µ—Ç –≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ dpkg -l)
if dpkg -l | grep -E "^ii[[:space:]]+${PACKAGE_NAME}[[:space:]]+" &> /dev/null; then
    echo "‚úÖ –ü–∞–∫–µ—Ç '$PACKAGE_NAME' **–≤–∂–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ** —É —Å–∏—Å—Ç–µ–º—ñ."
else
    echo "üî¥ –ü–∞–∫–µ—Ç '$PACKAGE_NAME' **–≤—ñ–¥—Å—É—Ç–Ω—ñ–π** —É —Å–∏—Å—Ç–µ–º—ñ."
    read -rp "–ë–∞–∂–∞—î—Ç–µ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Ü–µ–π –ø–∞–∫–µ—Ç –∑–∞—Ä–∞–∑? (y/N): " answer
    
    if [[ "$answer" =~ ^[Yy]$ ]]; then
        echo "‚öôÔ∏è –ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞ '$PACKAGE_NAME'. –ú–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –ø–∞—Ä–æ–ª—å sudo..."
        # –í–∏–∫–æ–Ω–∞–Ω–Ω—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞
        if sudo apt update && sudo apt install -y "$PACKAGE_NAME"; then
            echo "üéâ –ü–∞–∫–µ—Ç '$PACKAGE_NAME' —É—Å–ø—ñ—à–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ."
        else
            echo "‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è: –ù–µ –≤–¥–∞–ª–æ—Å—è –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞–∫–µ—Ç '$PACKAGE_NAME'."
            echo "–ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –Ω–∞–∑–≤–∞ –ø–∞–∫–µ—Ç–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ —ñ —É –≤–∞—Å —î –ø—Ä–∞–≤–∞ sudo."
        fi
    else
        echo "‚úã –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞–∫–µ—Ç–∞ '$PACKAGE_NAME' —Å–∫–∞—Å–æ–≤–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º."
    fi
fi

exit 0
